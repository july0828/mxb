<!DOCTYPE html>
<html lang="en">
<!-- Head -->
<head>
    <title>用户首页</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="keywords" content=""/>

    <!-- flexslider-css-file -->
    <link rel="stylesheet" href="css/flexslider.css" type="text/css" media="screen" property=""/>
    <!-- //flexslider-css-file -->

    <link rel="stylesheet" href="css/easy-responsive-tabs.css">

    <link href="css/font-awesome.css" rel="stylesheet">        <!-- font-awesome icons-css-file -->
    <link href="css/bootstrap.css" type="text/css" rel="stylesheet" media="all">    <!-- bootstrap-css-file -->
    <link href="css/styleuser.css" type="text/css" rel="stylesheet" media="all">    <!-- style-css-file -->
    <link rel="stylesheet" href="css/elementui-index.css">

    <!-- gallery -->
    <link rel="stylesheet" href="css/lightbox.css">
    <!-- //gallery -->

    <!-- fonts -->
    <link href="http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Cinzel:400,700,900" rel="stylesheet">
    <!-- //fonts -->

    <!-- Default-JavaScript-File -->
    <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
    <!-- //Default-JavaScript-File -->

    <script src="js/bootstrap.js"></script>    <!-- //bootstrap-JavaScript-File -->
</head>
<!-- Head -->

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">
<div id="app">
    <!-- banner -->
    <div id="home" class="w3ls-banner">
        <!-- header -->
        <div class="header-w3layouts">
            <!-- Navigation -->
            <nav class="navbar navbar-default navbar-fixed-top">
                <div class="container">
                    <div class="navbar-header page-scroll">
                        <button type="button" class="navbar-toggle" data-toggle="collapse"
                                data-target=".navbar-ex1-collapse">
                            <span class="sr-only">慢性病管理系统</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <h1><a class="navbar-brand" href="index.html">慢性病管理系统</a></h1>
                    </div>
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse navbar-ex1-collapse">
                        <ul class="nav navbar-nav navbar-right cl-effect-15">
                            <!-- Hidden li included to remove active class from about link when scrolled up past about section -->
                            <li class="hidden"><a class="page-scroll" href="#page-top"></a></li>
                            <li><a class="page-scroll scroll" href="index.html">首页</a></li>
                            <li><a class="page-scroll scroll" href="1doctors-list.html">医生列表</a></li>
                            <li><a class="page-scroll scroll" href="1abouts-list.html">知识库</a></li>
                            <li><a class="page-scroll scroll" href="1heath.html">健康评估</a></li>
                            <li><a class="page-scroll scroll" href="1personcenter.html">个人中心</a></li>
                            <li><a class="page-scroll scroll" v-on:click="login">后台管理</a></li>
                            <li><a class="page-scroll scroll" href="login.html">登录</a></li>
                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                </div>
                <!-- /.container -->
            </nav>
        </div>
        <div class="w3l_banner_info" style="padding-top: 20px;">
        </div>

        <div id="blog" class="banner-bottom blog" style="
    background-size: cover;
    background-attachment: fixed;">
            <div class="appointment" style="padding-top: 0px">
                <div class="container" style="color: antiquewhite">
                    <div class="w3ls-heading">
                        <h3 style="color: lightgoldenrodyellow">个人中心</h3>
                        <el-descriptions title="用户信息" :column="3" border>
                            <el-descriptions-item label="姓名" label-class-name="my-label"
                                                  content-class-name="my-content">{{user.name}}
                            </el-descriptions-item>
                            <el-descriptions-item label="年龄">{{user.age}}</el-descriptions-item>
                            <el-descriptions-item label="手机号">{{user.phone}}</el-descriptions-item>
                            <el-descriptions-item label="证件类型">{{user.type}}</el-descriptions-item>
                            <el-descriptions-item label="身份证号">{{user.idCard}}</el-descriptions-item>
                            <el-descriptions-item label="联系地址" :contentStyle="{'text-align': 'center'}">
                                {{user.address}}
                            </el-descriptions-item>

                        </el-descriptions>
                        <el-button type="info" @click="dialogFormVisible = true" style="margin-left: 1000px;margin-top: 20px">编辑个人信息</el-button>

                        <el-dialog title="个人信息" :visible.sync="dialogFormVisible">
                            <el-form :model="user">
                                <el-form-item label=姓名 :label-width="formLabelWidth">
                                    <el-input v-model="user.name" autocomplete="off" style="width: 180px"></el-input>
                                </el-form-item>
                                    <el-form-item label="证件类型" :label-width="formLabelWidth">
                                        <el-select v-model="user.type" placeholder="请选择证件类型" style="width: 180px">
                                            <el-option label="居民身份证" value="居民身份证"></el-option>
                                            <el-option label="护照" value="护照"></el-option>
                                            <el-option label="其他" value="其他"></el-option>
                                        </el-select>
                                    </el-form-item>
                                <el-form-item label="年龄" :label-width="formLabelWidth" >
                                    <el-input v-model="user.age" autocomplete="off" style="width: 180px"></el-input>
                                </el-form-item>

                                <el-form-item label="身份证号" :label-width="formLabelWidth" >
                                    <el-input v-model="user.idCard" autocomplete="off" style="width: 250px"></el-input>
                                </el-form-item>
                                <el-form-item label="手机号" :label-width="formLabelWidth" >
                                    <el-input v-model="user.phone" autocomplete="off" style="width: 250px"></el-input>
                                </el-form-item>
                                <el-form-item label="联系地址" :label-width="formLabelWidth">
                                    <el-input v-model="user.address" autocomplete="off" style="width: 400px"></el-input>
                                </el-form-item>
                            </el-form>
                            <div slot="footer" class="dialog-footer">
                                <el-button @click="dialogFormVisible = false">取 消</el-button>
                                <el-button type="primary" @click="update()">确 定</el-button>
                            </div>
                        </el-dialog>
                        <div style="margin-top: 20px">
                            <h3 style="color: lightgoldenrodyellow">我的预约</h3>
                        </div>

                    </div>
                    <div class="appointment-grid">

                        <el-row>
                            <el-col :span="6" v-for="(appointment, index) in appointments" :key="appointment.id"
                                    style="margin-left: 40px;margin-top: 30px">
                                <el-card class="box-card">
                                    <div slot="header" class="clearfix">
                                        <div>
                                            <span>姓名:{{appointment.name}}</span>
                                        </div>
                                        <div>
                                            <span>医生姓名:{{appointment.doctorName}}</span>
                                        </div>
                                        <div>
                                            <span>预约时间:{{appointment.time}}</span>
                                        </div>
                                        <div>
                                            <span>预约内容:{{appointment.content}}</span>
                                        </div>
                                    </div>
                                    <el-button round style="margin-left: 65px" @click="del(appointment.id)">取消预约
                                    </el-button>
                                </el-card>
                            </el-col>
                        </el-row>
                    </div>
                </div>
            </div>
        </div>


        <script src="js/easy-responsive-tabs.js"></script>
        <script>
            $(document).ready(function () {
                $('#horizontalTab').easyResponsiveTabs({
                    type: 'default', //Types: default, vertical, accordion
                    width: 'auto', //auto or any width like 600px
                    fit: true,   // 100% fit in a container
                    closed: 'accordion', // Start closed if in accordion view
                    activate: function (event) { // Callback function if tab is switched
                        var $tab = $(this);
                        var $info = $('#tabInfo');
                        var $name = $('span', $info);
                        $name.text($tab.text());
                        $info.show();
                    }
                });
                $('#verticalTab').easyResponsiveTabs({
                    type: 'vertical',
                    width: 'auto',
                    fit: true
                });
            });
        </script>
        <script src="js/responsiveslides.min.js"></script>
        <script>
            // You can also use "$(window).load(function() {"
            $(function () {
                // Slideshow 4
                $("#slider3").responsiveSlides({
                    auto: true,
                    pager: true,
                    nav: false,
                    speed: 500,
                    namespace: "callbacks",
                    before: function () {
                        $('.events').append("<li>before event fired.</li>");
                    },
                    after: function () {
                        $('.events').append("<li>after event fired.</li>");
                    }
                });

            });
        </script>
        <link rel="stylesheet" href="css/jquery-ui.css"/>
        <script src="js/jquery-ui.js"></script>
        <script>
            $(function () {
                $("#datepicker").datepicker();
            });
        </script>
        <script src="js/SmoothScroll.min.js"></script>
        <script type="text/javascript" src="js/jquery.flexisel.js"></script>
        <script type="text/javascript">
            $(window).load(function () {
                $("#flexiselDemo1").flexisel({
                    visibleItems: 3,
                    animationSpeed: 1000,
                    autoPlay: false,
                    autoPlaySpeed: 3000,
                    pauseOnHover: true,
                    enableResponsiveBreakpoints: true,
                    responsiveBreakpoints: {
                        portrait: {
                            changePoint: 480,
                            visibleItems: 1
                        },
                        landscape: {
                            changePoint: 640,
                            visibleItems: 2
                        },
                        tablet: {
                            changePoint: 768,
                            visibleItems: 3
                        }
                    }
                });

            });
        </script>
        <script type="text/javascript" src="js/move-top.js"></script>
        <script type="text/javascript" src="js/easing.js"></script>
        <!--        <script type="text/javascript">-->
        <!--            jQuery(document).ready(function ($) {-->
        <!--                $(".scroll").click(function (event) {-->
        <!--                    event.preventDefault();-->
        <!--                    $('html,body').animate({scrollTop: $(this.hash).offset().top}, 1000);-->
        <!--                });-->
        <!--            });-->
        <!--        </script>-->
        <script type="text/javascript">
            $(document).ready(function () {
                /*
                    var defaults = {
                    containerID: 'toTop', // fading element id
                    containerHoverID: 'toTopHover', // fading element hover id
                    scrollSpeed: 1200,
                    easingType: 'linear'
                    };
                */

                $().UItoTop({easingType: 'easeOutQuart'});

            });
        </script>
        <script src="js/scrolling-nav.js"></script>
    </div>
</div>
</body>

<script src="js/vue.min.js"></script>
<!-- import JavaScript -->
<!-- 引入组件库 -->
<script src="js/elementui-index.js"></script>
<script src="js/axios.min.js"></script>
<script>
    let v = new Vue({
        el: '#app',
        data: function () {
            return {
                size: '',
                appointments: [{
                    name: "",
                    time: "",
                    content: "",
                    doctorName: "",
                    userId: "",
                    id: ""
                }],
                user: {
                    name: "",
                    age: "",
                    type: "",
                    address: "",
                    idCard: "",
                    phone: ""
                },
                dialogFormVisible: false,
                formLabelWidth: '120px'
            }
        },
        methods: {
            login() {
                axios.get("/userLoginIndex").then(function (response) {
                    let a = response.data;
                    console.log(a)
                    switch (a) {
                        case 1:
                            location.href = "/index.html";
                            break;
                        case 2:
                            location.href = "/index2.html";
                            break;
                        case 3:
                            location.href = "/index3.html";
                            break;
                        case 0:
                            alert("请登录");
                            location.href = "/login.html"
                            break;
                        default:
                            break;
                    }
                })
            },
            del(id) {
                axios.get("/appointment/delete?id=" + id).then(function (response) {
                    alert(response.data)
                    location.reload();
                })
            },
            handleClose(done) {
                this.$confirm('确认关闭？')
                    .then(_ => {
                        done();
                    })
                    .catch(_ => {
                    });
            },
            update(){
                axios.post("/user/update", v.user).then(function (response) {
                    alert(response.data)
                    v.dialogFormVisible = false;
                })
            }
        },
        created: function () {
            axios.get("/userLoginIndex2").then(function (response) {
                v.user.acountId = response.data.id;
                v.user.name = response.data.username;
                if (v.user.name == null) {
                    location.href = "login.html"
                }
                axios.get("/appointment/selectAllById?userId=" + response.data.id).then(function (response1) {
                    v.appointments = response1.data;
                })
                axios.get("/user/selectByAcountId?acountId=" + response.data.id).then(function (response2) {
                    v.user = response2.data;
                })
            })


        }
    })


</script>
</html>